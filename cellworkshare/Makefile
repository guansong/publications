###############################################################################
# $Date: 2008-12-14 06:11:13 $
###############################################################################

TARGET =workshare

MODULES=workshare.tex \
	workshare.bib \
	title.tex \
	abstract.tex \
	section1.tex \
	  runtime.eps \
	section2.tex \
	  clone.eps \
	section3.tex \
	section4.tex \
	  fetchandadd.eps \
	  combined.eps \
	section5.tex \
	section6.tex \
	epilog.tex

###############################################################################
# Makefile for general latex related.
###############################################################################
SHELL   = /bin/sh
DEBUG   = 

LATEX   = latex
BIBTEX  = bibtex
DVIPS   = dvips -z
XDVI    = xdvi -s 6
FIG2DEV = fig2dev
GNUPLOT = gnuplot

PS2PDF  = ps2pdf

ISPELL  = ispell

GHOSTVIEW  = ghostview
XPDF       = xpdf 
LATEX2HTML = latex2html

.SUFFIXES:
.SUFFIXES: .tex .bib .bbl .dvi .ps .pdf .fig .plt .eps

.tex.dvi:
	$(LATEX) $* && \
	$(BIBTEX) $* && \
	sed 's/^$$/% -------------- Generated by bibtex, edit $*.bib if needed --------------/' \
            $*.bbl > $*.bbl.tmp && \
	mv $*.bbl.tmp $*.bbl
	$(LATEX) $* && \
	$(LATEX) $*

.dvi.ps:
	$(DVIPS) $*.dvi -o $*.ps

.ps.pdf:
	$(PS2PDF) $*.ps $*.pdf

.fig.eps:
	$(FIG2DEV) -L eps $*.fig $*.eps

.plt.eps:
	$(GNUPLOT) $*.plt > $*.eps

default: dvi

all: ps pdf spell

view: dvi
	$(XDVI) $(TARGET).dvi &

psview: ps 
	$(GHOSTVIEW) $(TARGET).ps &

pdfview: pdf
	$(XPDF) $(TARGET).pdf &


spell:
	@echo
	for i in $(MODULES); do echo  ------ $$i; cat $$i | $(ISPELL) -l -t -p $(TARGET).dic; done

dics:
	@for i in $(MODULES); do echo  ------ $$i; echo "cat $$i | $(ISPELL) -l -t | sort | uniq > $$i.dic" ; cat $$i | $(ISPELL) -l -t | sort | uniq > $$i.dic; done


$(TARGET).dvi: $(MODULES)

dvi: $(TARGET).dvi

ps: $(TARGET).ps

pdf: $(TARGET).pdf

html: $(TARGET)/$(TARGET).html

# leaving generated eps as our plugin
clean:
	rm -f $(TARGET).ps *.pdf *.dvi 
	rm -f *.aux *.log *.toc *.out
	rm -f *.bbl *.blg  
	rm -f *.bak *.tmp 
	rm -f *~
	rm -rf $(TARGET)

# for web
$(TARGET)/$(TARGET).html: $(TARGET).dvi
	$(LATEX2HTML) $(TARGET)

###############################################################################
# detailed dependency
###############################################################################


